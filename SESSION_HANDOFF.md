# セッション引き継ぎファイル

> **最終更新**: 2026-02-13
> **作業ブランチ**: `claude/create-handoff-docs-tRAuI`
> **最新コミット**: `c13137f 大カテゴリと中カテゴリの見出しデザインを差別化`

---

## 必須ルール（全セッション共通）

### 1. 変更プッシュ後は毎回デプロイ手順を表示すること

コードを変更してプッシュしたら、**必ず毎回**以下を表示する：

```
cd C:\Users\yamas\Desktop\For_OpenHands\minpaku-fix
git pull origin claude/create-handoff-docs-tRAuI
node deploy-all.js
```

### 2. チャット移行時は引き継ぎ資料を更新すること

セッション終了・チャット移行時には、`SESSION_HANDOFF.md` と `HANDOFF.md` を最新状態に更新してコミット＆プッシュする。

### 3. 常に日本語で応答すること

---

## 必須デプロイコマンド（ユーザーのWindows PCで実行）

```
cd C:\Users\yamas\Desktop\For_OpenHands\minpaku-fix
git pull origin claude/create-handoff-docs-tRAuI
node deploy-all.js
```

**注意**: コードの変更後は必ず上記を実行しないとGASに反映されません。

---

## 新しいセッションへの指示

### 最初にやること

1. **このファイルを読む**（`SESSION_HANDOFF.md`）
2. **HANDOFF.md も読む**（プロジェクト全体の構成・技術仕様が記載）
3. **ブランチの確認**:
   ```
   git fetch origin claude/create-handoff-docs-tRAuI
   git log origin/claude/create-handoff-docs-tRAuI --oneline -10
   ```

---

## 今回のセッションで完了した作業

### 1. 大カテゴリと中カテゴリの見出しデザイン差別化
- **大カテゴリ**: 濃紺背景（`#2c3e50`）＋白文字＋白アイコン → 目立つ帯状デザイン
- **中カテゴリ**: 薄い青背景（`#eaf2fb`）＋青アイコン（`#3498db`）→ 軽めのデザイン
- **小カテゴリ**: オレンジアイコン（`#e67e22`）を明示的に設定
- **細カテゴリ**: 紫アイコン（`#9b59b6`）を明示的に設定
- 大カテゴリの「全チェック」ボタンも白系に調整
- 未完了時の大カテゴリは赤背景（`#c0392b`）

### 2. 前セッションまでの完了作業
- チェックリストUI改善（サムネイル3倍化、ボタン右寄せ、項目削除、状態維持）
- チェックリスト4階層対応（大：中：小：細）+ CSV全558項目
- タブナビ移動、漏れチェック統合、メモ自動保存、項目名タッチ対応
- 見本写真サムネイル表示、撮影箇所レイアウト整備
- カテゴリ階層ボタン追加、追加ボタン控えめデザイン

---

## 未完了・要確認事項

### スプレッドシートのデータ問題（コード修正不要）
- **2/23 日付の黄色背景が消えない**: 「募集」シートに2/23の行が「募集中」のまま残っている → 該当行を削除 or ステータス変更
- **「西山PCテスト」の▲表示**: 「募集_立候補」シートに回答データ（△）が残存 → 該当行を削除

### デプロイ後の確認必要
- 大カテゴリ・中カテゴリの見出しデザイン差別化が実機で正しく表示されるか
- 558項目の4階層チェックリストが正しく表示されるか
- 折りたたみの開閉、全チェック、項目追加/削除が正常動作するか

### 将来の課題（HANDOFF.mdにも記載）
- 条件分岐対応（BBQ利用あり/なし、宿泊人数による表示切替）
- 在庫管理リスト機能
- リネン洗濯フロー管理

---

## 主要ファイル構成

| ファイル | 行数（概算） | 役割 |
|----------|-------------|------|
| `Code.gs` | ~6700行 | メインアプリ（予約管理）サーバー |
| `index.html` | ~6000行 | メインアプリ フロントエンド |
| `checklist-app/Code.gs` | ~1700行 | チェックリストアプリ サーバー |
| `checklist-app/checklist.html` | ~2300行 | チェックリストアプリ フロントエンド |
| `checklist-app/cleaning_checklist.csv` | 759行 | チェックリスト元データ（Notionからエクスポート） |
| `deploy-all.js` | 166行 | 一括デプロイスクリプト |
| `HANDOFF.md` | ~380行 | プロジェクト全体の技術資料 |

---

## 技術的な注意点

### カテゴリの区切り文字
- 全角コロン `：`（U+FF1A）を使用
- 例: `テラス：次の予約がBBQ利用あり：↓セット内容↓`

### レンダリングの仕組み
- `buildCategoryTree()` が全アイテムをツリー構造に変換
- `renderCategoryNode()` が再帰的にHTMLを生成
- レベル0=`.section`（濃紺）、1=`.sub-section`（薄青）、2=`.sub-sub-section`（オレンジ）、3=`.sub-sub-sub-section`（紫）

### データ保存
- GASのSpreadsheetService（Google Sheets）をバックエンドDBとして使用
- チェック状態は日付ごとに管理（シート名: `CL_YYYY-MM-DD`）
- マスターデータ: `CL_マスター`（項目定義）、`CL_撮影箇所`（撮影箇所定義）
